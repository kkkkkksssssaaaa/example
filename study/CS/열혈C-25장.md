# [CS] 👽 열혈C프로그래밍

---

## 25장. 메모리 관리와 메모리의 동적 할당

### 25.1 C언어의 메모리 구조

- 메모리의 구조
    - `스택 영역`
        - 지역변수, 매개변수처럼 함수를 벗어나면 사라지는 변수를 저장
    - `힙 영역`
        - 생성/소멸 시점이 결정 되어 있지 않은 데이터
        - 프로그래머가 원하는 시점에서 할당하고, 소멸할 수 있도록 지원하는 변수가 저장됨
        - `malloc` 과 `free` 로 힙 영역에 할당하고 해제할 수 있음
        - 프로그래머가 관리하는 메모리 공간
    - `데이터 영역`
        - 전역 변수나 static 으로 선언 되는 변수들
        - 프로그램 종료 시 까지 남아있음
    - `코드(텍스트) 영역)`
        - 실행할 프로그램의 코드 자체가 저장 됨
        - 이 메모리에서 실행할 코드를 불러옴

### 25.2 메모리의 동적 할당

- ❓ `malloc` 이 void pointer 를 반환하는 이유
    - `malloc(sizeof(int))` 이런 식으로 메모리를 할당 했을 때 실제로 수행되는건 `malloc(4)` 임
    - 그러므로 메모리 입장에서는 숫자 4만 들어오고 이 것이 정수형 변수인지, 실수형 변수인지 알 길이 없기 때문에 `malloc` 으로 리턴받은 포인터는 꼭 타입을 지정해야 함
- `malloc` 으로 할당하는 메모리 공간을 할당 하는 것을 `동적 할당` 이라고 함
    - 할당 되는 메모리의 크기를 컴파일러가 결정하지 않고, 프로그램 실행 중간에 호출되는 `malloc` 이 결정하기 때문
- `free` 를 선언하지 않아도 프로그램이 종료되면 운영체제에 의해 해당 프로그램이 사용한 모든 메모리가 해제됨
    - 그러니까 서버 프로그램처럼 안끝나야 하는 프로그램이면 영원히 남아 있을 수 있음 ㅎㄷㄷ
- `malloc` 의 선언 횟수만큼 `free` 의 선언도 잊지 말자
- `calloc` 이라는 것도 있는데 `malloc` 과 메모리 공간 할당을 위한 인자 전달 방식만 차이가 있음
    - 인자가 두개 들어감
    - 배열 때문에 만들어진듯
- `realloc` 이라는 것도 있는데 이건 한 번 할당된 메모리 공간은 그 크기를 확장할 수 없다는 특징 때문에 나온 것인데, 힙 메모리에 할당 된 변수들의 공간의 크기를 조절하기 위해 사용함
    - 힙 메모리만 가능