# [CS] 👽 열혈C프로그래밍

---

## 26장. 매크로와 선행처리기(Preprocessor)

### 26.1 선행처리기와 매크로

- 실행 파일은 컴파일 이전에 선행처리라는 것을 거침
- ❓ 실행 파일의 실행 과정
    1. 소스 파일이 선행 처리
    2. 선행처리된 파일이 컴파일
    3. 컴파일러가 오브젝트 파일을 생성
    4. 오브젝트 파일이 링커를 통해 실행 파일로 병합
- 선행처리 과정을 거쳐 나오는 결과물도 그냥 소스 파일일 뿐
- 선행처리기가 하는 일은 선행 처리 명령문대로 소스코드의 일부를 수정
    - 선행처리의 수정은 단순한 치환 형태를 띄는 경우가 대부분임

### 26.2 대표적인 선행처리 명령문

- e.g. `#define PI 3.1415` 라는 선행처리 명령문이 있음
    - 선행처리 명령문은 세 가지로 구성
        - 프로그래머가 지시하는 바를 파악하기 위한 `지시자(#define)`
        - 변수 이름 같기도한 `매크로(PI)`
        - 매크로의 치환 값인 `매크로 몸체 혹은 대체 리스트(3.1415)`
    - 위와 같은 매크로는 그냥 `매크로 상수` 라고 함
- 함수형 매크로도 있음
    - e.g. `#define SQUARE(X) X*X` 가 있을 때
        - `SQUARE(1)` 매크로가 사용된 구문이 있다면 선행 처리 된 단계에서 이를 `1 * 1` 로 치환
        - 그대로 치환하기 때문에 `SQUARE(3 + 2)` 라는 매크로를 사용하면 `3 + 2 * 3 + 2` 가 실행되는 대참사가 일어남
        - 그러니까 몸체에 괄호를 사용하여 적절하게 미리 대응하자
- 선행 처리에 의해 코드가 치환 되는 과정을 `매크로 확장` 이라고 함
- 게임 매크로랑 개념 자체는 비슷한 듯
    - 특정 키를 누르면 특정 입력이 실행 되는 거니까
- 매크로는 변수처럼 쓸 수 있어서 먼저 선언된 매크로라면 나중에 선언될 매크로에도 사용 가능함
- 매크로 함수는 일반 함수에 비해 실행 속도가 빠름
- 자료형에 따라 별도의 함수를 정의하지 않아도 됨

### 26.3 조건부 컴파일(Conditional Compilation) 을 위한 매크로

- `#if...#endif` 이런거
    - 조건이 참이면 해당 코드가 반영되고 거짓이면 코드 자체가 날라가는 듯

### 26.4 매개변수의 결합과 문자열화

- 문자열 내에선 매크로의 매개변수 치환이 발생하지 않음